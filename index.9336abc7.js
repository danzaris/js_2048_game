var t,e={};const o=new((t=class{constructor(t=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]){this.board=t,this.score=0,this.status="idle"}getScore(){return this.score}getState(){return this.board}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}addRandomTile(){let t=[];for(let e=0;e<this.board.length;e++)for(let o=0;o<this.board[e].length;o++)0===this.board[e][o]&&t.push({row:e,col:o});if(t.length>0){let e=Math.floor(Math.random()*t.length),{row:o,col:s}=t[e];this.board[o][s]=.1>Math.random()?4:2}}checkWinCondition(){for(let t of this.board)if(t.includes(2048)){this.status="win";return}}checkLoseCondition(){for(let t of this.board)if(t.includes(0))return;for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[t].length-1;e++)if(this.board[t][e]===this.board[t][e+1])return;for(let t=0;t<this.board[0].length;t++)for(let e=0;e<this.board.length-1;e++)if(this.board[e][t]===this.board[e+1][t])return;this.status="lose"}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let o=[...this.board[e]],s=o.filter(t=>0!==t);for(let t=0;t<s.length-1;t++)s[t]===s[t+1]&&(s[t]*=2,this.score+=s[t],s[t+1]=0);for(s=s.filter(t=>0!==t);s.length<4;)s.push(0);o.toString()!==s.toString()&&(t=!0),this.board[e]=s}t&&this.addRandomTile(),this.checkWinCondition(),this.checkLoseCondition()}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let o=[...this.board[e]],s=o.filter(t=>0!==t);for(let t=s.length-1;t>0;t--)s[t]===s[t-1]&&(s[t]*=2,this.score+=s[t],s[t-1]=0);for(s=s.filter(t=>0!==t);s.length<4;)s.unshift(0);o.toString()!==s.toString()&&(t=!0),this.board[e]=s}t&&this.addRandomTile(),this.checkWinCondition(),this.checkLoseCondition()}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let o=[this.board[0][e],this.board[1][e],this.board[2][e],this.board[3][e]],s=[...o],r=o.filter(t=>0!==t);for(let t=0;t<r.length-1;t++)r[t]===r[t+1]&&(r[t]*=2,this.score+=r[t],r[t+1]=0);for(r=r.filter(t=>0!==t);r.length<4;)r.push(0);s.toString()!==r.toString()&&(t=!0);for(let t=0;t<4;t++)this.board[t][e]=r[t]}t&&this.addRandomTile(),this.checkWinCondition(),this.checkLoseCondition()}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let o=[this.board[0][e],this.board[1][e],this.board[2][e],this.board[3][e]].filter(t=>0!==t);for(let t=o.length-1;t>0;t--)o[t]===o[t-1]&&(o[t]*=2,this.score+=o[t],o[t-1]=0);for(o=o.filter(t=>0!==t);o.length<4;)o.unshift(0);[this.board[0][e],this.board[1][e],this.board[2][e],this.board[3][e]].toString()!==o.toString()&&(t=!0);for(let t=0;t<4;t++)this.board[t][e]=o[t]}t&&this.addRandomTile(),this.checkWinCondition(),this.checkLoseCondition()}restart(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}reset(){this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}hasValidMoves(){if(this.board.some(t=>t.includes(0)))return!0;for(let t=0;t<4;t++)for(let e=0;e<4;e++){let o=this.board[t][e];if(e<3&&o===this.board[t][e+1]||t<3&&o===this.board[t+1][e])return!0}return!1}checkWin(){for(let t=0;t<4;t++)if(this.board[t].includes(2048))return this.status="won",!0;return!1}}).__esModule?t.default:t),s=document.querySelector(".game-score"),r=document.querySelector(".button.start"),i=document.getElementById("game-board");function n(t){i.innerHTML="",t.forEach(t=>{let e=document.createElement("tr");e.classList.add("row"),t.forEach(t=>{let o=document.createElement("td");o.classList.add("cell"),o.textContent=0!==t?t:"",e.appendChild(o)}),i.appendChild(e)}),function(t){let e=document.querySelectorAll(".cell");t.forEach((t,o)=>{t.forEach((t,s)=>{let r=e[4*o+s];r.className="cell",t>0?(r.classList.add(`cell--${t}`),r.textContent=t):r.textContent=""})})}(t)}function a(t){let e=document.querySelector(".message-lose"),o=document.querySelector(".message-win"),s=document.querySelector(".message-start");e.classList.add("hidden"),o.classList.add("hidden"),s.classList.add("hidden"),"win"===t?o.classList.remove("hidden"):"lose"===t?e.classList.remove("hidden"):"start"===t&&s.classList.remove("hidden")}function d(t){if("playing"===o.getStatus()){switch(t.key){case"ArrowLeft":o.moveLeft();break;case"ArrowRight":o.moveRight();break;case"ArrowUp":o.moveUp();break;case"ArrowDown":o.moveDown()}n(o.getState()),s.textContent=o.getScore(),o.checkWin()?(a("win"),document.removeEventListener("keydown",d)):o.hasValidMoves()||(a("lose"),document.removeEventListener("keydown",d))}}function l(){o.start(),n(o.getState()),s.textContent=o.getScore(),a("start"),document.querySelector(".game-score").textContent="0",document.querySelector(".message-start").classList.add("hidden"),r.textContent="Restart",r.removeEventListener("click",l),r.addEventListener("click",h);let t=document.querySelector(".button.start");t&&(t.classList.remove("start"),t.classList.add("restart")),document.addEventListener("keydown",d)}function h(){o.reset(),n(o.getState()),s.textContent=o.getScore(),a("start"),r.textContent="Start",r.removeEventListener("click",h),r.addEventListener("click",l);let t=document.querySelector(".button.restart");t&&(t.classList.remove("restart"),t.classList.add("start")),document.addEventListener("keydown",d)}document.addEventListener("DOMContentLoaded",()=>{r&&r.addEventListener("click",l),n(o.getState())});
//# sourceMappingURL=index.9336abc7.js.map
